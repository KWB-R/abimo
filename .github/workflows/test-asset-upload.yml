name: Test asset upload

on: push

jobs:
  main_job:
    name: Main Job
    runs-on: windows-latest
    env:
      ZIP_NAME: abimo_latest_win64.zip
    steps:
#      - name: Checkout
#        uses: actions/checkout@v3
      - name: Fake the result of a build process
        shell: cmd
        run: |
          mkdir release
          echo "build result" > release/windows-release.txt
      - name: Create zip-file
        shell: pwsh
        run: |
          cd release
          Compress-Archive * ${{ env.ZIP_NAME }}
      - name: List files
        shell: cmd
        run: dir /s /b
      - name: Update Windows-related asset in latest release
        uses: softprops/action-gh-release@v1
        with:
          tag_name: latest-1
          files: ${{ env.ZIP_NAME }}
